<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Extracting buffers – BeeSpatial Tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b2c493fdd487b110f6b1348dfd6a5174.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introgis.html">Working with BeeSpatial data in R</a></li><li class="breadcrumb-item"><a href="./rasterBuffer.html">Extracting buffers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BeeSpatial Tutorial</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">How to use BeeSpatial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BeeSpatialBound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get raster data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BeeSpatialPts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Query points</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Working with BeeSpatial data in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introgis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GIS and R prerequisites</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rasterViz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizing rasters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rasterReclass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reclassify CDL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rasterBuffer.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Extracting buffers</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#read-in-point-data" id="toc-read-in-point-data" class="nav-link" data-scroll-target="#read-in-point-data">Read in point data</a></li>
  <li><a href="#visualize-point-data" id="toc-visualize-point-data" class="nav-link" data-scroll-target="#visualize-point-data">Visualize point data</a></li>
  <li><a href="#buffer-around-points" id="toc-buffer-around-points" class="nav-link" data-scroll-target="#buffer-around-points">Buffer around points</a></li>
  <li><a href="#extract-cdl-values-within-buffers" id="toc-extract-cdl-values-within-buffers" class="nav-link" data-scroll-target="#extract-cdl-values-within-buffers">Extract CDL values within buffers</a></li>
  <li><a href="#write-out-shapefiles" id="toc-write-out-shapefiles" class="nav-link" data-scroll-target="#write-out-shapefiles">Write out shapefiles</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introgis.html">Working with BeeSpatial data in R</a></li><li class="breadcrumb-item"><a href="./rasterBuffer.html">Extracting buffers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Extracting buffers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>BeeSpatial provides forage, nesting, and insecticide rasters as buffered summaries using distance-weighted means of 1, 3, and 5km radius buffers. This means that each pixel of the raster represents the distance-weighted mean of the index values within the corresponding buffer radius. Only the CDL output summary is not a distance-weighted mean. It is the proportion of each land cover class.</p>
<p>If you want your own buffer summaries of the CDL or forage, nesting, or insecticide indices, this tutorial shows how to do that using proportional area (for CDL) or simple means (habitat indices).</p>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<p>First, load the necessary packages. More info on these packages and their installation can be found <a href="./introgis.html#loading-necessary-packages">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyterra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Read in the CDL data downloaded from BeeSpatial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>centre_cdl <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">"data/CDL_2021_FIPS_42027.tif"</span>)    <span class="co"># change the filepath to reflect where you've stored the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-in-point-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-point-data">Read in point data</h2>
<p>Often we collect and store point data as coordinates in a non-spatial format such as a csv file which we need to convert into a spatial object in R.</p>
<p>In the /data directory you should find a csv file with a set of points from Centre County Pa. We will read in and inspect these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>centre_sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/centre_co_pts.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>centre_sites</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  SiteID      Long      Lat
1  Site1 -77.70654 40.80497
2  Site2 -77.89991 40.74921
3  Site3 -77.93778 41.00641
4  Site4 -77.86590 40.81954
5  Site5 -77.64715 41.02197
6  Site6 -77.84409 40.87366
7  Site7 -77.77373 40.82634
8  Site8 -77.69934 40.87697</code></pre>
</div>
</div>
<p>and convert them into an sf spatial object. We use the <code>coords=</code> argument to indicate the columns that hold the longitude (X) and latitude (Y). We can also specify the CRS using the ‘crs=’ arguments and the appropriate EPSG code or other crs object. In our case we will give the EPSG code 4326 which corresponds to WGS 84, the system commonly used by Google Earth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>centre_sites <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(centre_sites, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>), <span class="co">#indicate the x and y columns</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co">#set the crs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>when we inspect the center_sites object we see that there is now additional information at the top.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>centre_sites</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 8 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -77.93778 ymin: 40.74921 xmax: -77.64715 ymax: 41.02197
Geodetic CRS:  WGS 84
  SiteID                   geometry
1  Site1 POINT (-77.70654 40.80497)
2  Site2 POINT (-77.89991 40.74921)
3  Site3 POINT (-77.93778 41.00641)
4  Site4  POINT (-77.8659 40.81954)
5  Site5 POINT (-77.64715 41.02197)
6  Site6 POINT (-77.84409 40.87366)
7  Site7 POINT (-77.77373 40.82634)
8  Site8 POINT (-77.69934 40.87697)</code></pre>
</div>
</div>
</section>
<section id="visualize-point-data" class="level2">
<h2 class="anchored" data-anchor-id="visualize-point-data">Visualize point data</h2>
<p>Using <code>ggplot2</code> and <code>sf</code> we can add our points to our earlier map of Centre county with the <code>geom_sf()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Centre county CDL from raster exercise</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>centre_cdl <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">"data/centre_county_cdl_2021.tif"</span>) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> centre_cdl, <span class="fu">aes</span>(<span class="at">fill =</span> class_name)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>centre_sites) <span class="sc">+</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>), </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>), </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">'cm'</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;SpatRaster&gt; resampled to 500797 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rasterBuffer_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="buffer-around-points" class="level2">
<h2 class="anchored" data-anchor-id="buffer-around-points">Buffer around points</h2>
<p>We can create a polygon object from our points by buffering around them in a 1000m radius. For example, we might do this when assessing land cover values around a site.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>centre_sites_1000m <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(centre_sites, <span class="dv">1000</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>centre_sites_1000m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 8 features and 1 field
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -77.94977 ymin: 40.74008 xmax: -77.63518 ymax: 41.03112
Geodetic CRS:  WGS 84
  SiteID                       geometry
1  Site1 POLYGON ((-77.70945 40.8137...
2  Site2 POLYGON ((-77.90568 40.7412...
3  Site3 POLYGON ((-77.92781 41.0013...
4  Site4 POLYGON ((-77.85495 40.8230...
5  Site5 POLYGON ((-77.65648 41.0163...
6  Site6 POLYGON ((-77.84816 40.8651...
7  Site7 POLYGON ((-77.76805 40.8184...
8  Site8 POLYGON ((-77.69978 40.886,...</code></pre>
</div>
</div>
<p>We can visualize this buffer by adding it to our plot. Note you may need to expand your plot size to see the buffers behind the points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> centre_cdl, <span class="fu">aes</span>(<span class="at">fill =</span> class_name)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> centre_sites_1000m)<span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>centre_sites) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>), </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>), </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">'cm'</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;SpatRaster&gt; resampled to 500797 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rasterBuffer_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extract-cdl-values-within-buffers" class="level2">
<h2 class="anchored" data-anchor-id="extract-cdl-values-within-buffers">Extract CDL values within buffers</h2>
<p>If we wanted to assess land cover around a site in a way that is similar to the results that beeshiny provides, we can use the <code>extract()</code> function from terra. First providing the raster we want to extract values from, then the sf object that defines the zones in which the raster will the summarized.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>centre_table_1000m <span class="ot">&lt;-</span> <span class="fu">extract</span>(centre_cdl, centre_sites_1000m, <span class="at">fun=</span><span class="st">"table"</span>, <span class="at">ID=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: [extract] transforming vector data to the CRS of the raster</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>centre_table_1000m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Background Corn Cotton Rice Sorghum Soybeans Sunflower Peanuts Tobacco
1          0 1241      0    0      12     1021         0       0       0
2          0 1167      0    0       0      968         0       0       0
3          0    0      0    0       0        0         0       0       0
4          0   64      0    0       0       80         0       0       0
5          0   18      0    0       1        5         0       0       0
6          0  882      0    0       1      836         0       0       0
7          0    0      0    0       0        0         0       0       0
8          0   92      0    0       0        0         0       0       0
  Sweet Corn Pop or Orn Corn Mint Barley Durum Wheat Spring Wheat Winter Wheat
1          0               0    0      0           0            0          225
2          0               0    0      7           0            0          445
3          0               0    0      0           0            0            0
4          0               0    0      1           0            0            7
5          0               0    0      0           0            0            1
6          0               0    0      1           0            0           24
7          0               0    0      0           0            0            0
8          0               0    0      0           0            0            0
  Other Small Grains Dbl Crop WinWht/Soybeans Rye Oats Millet Speltz Canola
1                  0                        0   2   20      0      0      0
2                  0                        0   7  136      0      0      0
3                  0                        0   0    0      0      0      0
4                  0                        0   0    0      0      0      0
5                  0                        0   0    0      0      0      0
6                  0                        0   0    0      0      0      0
7                  0                        0   0    0      0      0      0
8                  0                        0   0    0      0      0      0
  Flaxseed Safflower Rape Seed Mustard Alfalfa Other Hay/Non Alfalfa Camelina
1        0         0         0       0     156                    88        0
2        0         0         0       0     100                    29        0
3        0         0         0       0       0                     0        0
4        0         0         0       0      82                   410        0
5        0         0         0       0       2                    50        0
6        0         0         0       0     124                   407        0
7        0         0         0       0       0                     0        0
8        0         0         0       0       4                    25        0
  Buckwheat Sugarbeets Dry Beans Potatoes Other Crops Sugarcane Sweet Potatoes
1         0          0        43        0           0         0              0
2         0          0       118        0           0         0              0
3         0          0         0        0           0         0              0
4         0          0         0        0           0         0              0
5         0          0         1        0           0         0              0
6         0          0         0        0           0         0              0
7         0          0         0        0           0         0              0
8         0          0         0        0           0         0              0
  Misc Vegs &amp; Fruits Watermelons Onions Cucumbers Chick Peas Lentils Peas
1                  0           0      0         0          0       0    0
2                  0           0      0         0          0       0    0
3                  0           0      0         0          0       0    0
4                  0           0      0         0          0       0    0
5                  0           0      0         0          0       0    0
6                  0           0      0         0          0       0    0
7                  0           0      0         0          0       0    0
8                  0           0      0         0          0       0    0
  Tomatoes Caneberries Hops Herbs Clover/Wildflowers Sod/Grass Seed Switchgrass
1        0           0    0     0                  0              0           0
2        0           0    0     0                  0              0           0
3        0           0    0     0                  0              0           0
4        1           0    0     0                  0              0           0
5        1           0    0     0                  0              0           0
6        0           0    0     0                  0              0           0
7        0           0    0     0                  0              0           0
8        0           0    0     0                  0              0           0
  Fallow/Idle Cropland Forest Cherries Peaches Apples Grapes Christmas Trees
1                    0      0        0       0      0      0               0
2                    0      0        0       0      0      0               0
3                    0      0        0       0      0      0               0
4                    0      0        0       0      1      0               0
5                    0      0        0       0      0      0               0
6                    0      0        0       0      1      0               0
7                    0      0        0       0      0      0               0
8                    0      0        0       0      0      0               0
  Other Tree Crops Citrus Pecans Almonds Walnuts Pears Clouds/No Data Developed
1                0      0      0       0       0     0              0         0
2                0      0      0       0       0     0              0         0
3                0      0      0       0       0     0              0         0
4                0      0      0       0       0     0              0         0
5                0      0      0       0       0     0              0         0
6                0      0      0       0       0     0              0         0
7                0      0      0       0       0     0              0         0
8                0      0      0       0       0     0              0         0
  Water Wetlands Nonag/Undefined Aquaculture Open Water Perennial Ice/Snow
1     0        0               0           0          0                  0
2     0        0               0           0          0                  0
3     0        0               0           0          0                  0
4     0        0               0           0          0                  0
5     0        0               0           0       1621                  0
6     0        0               0           0          0                  0
7     0        0               0           0          0                  0
8     0        0               0           0          0                  0
  Developed/Open Space Developed/Low Intensity Developed/Med Intensity
1                  224                      69                      22
2                   52                      95                      45
3                  208                       9                       2
4                  298                     367                     401
5                  172                      95                      33
6                  299                     214                      22
7                  135                       1                       0
8                  162                       8                       1
  Developed/High Intensity Barren Deciduous Forest Evergreen Forest
1                        2      4              178               10
2                        8      0              116                1
3                        0      0             3263                1
4                      137      1              474              106
5                        0      7              391               35
6                        4      1              236                6
7                        0      0             3358                9
8                        0      7             2216              533
  Mixed Forest Shrubland Grassland/Pasture Woody Wetlands Herbaceous Wetlands
1           22         0               213              0                   0
2           12         0               241              0                   0
3           56         0                 9              0                   0
4          303         1               806              0                   0
5          692         1               415              5                   1
6           56         1               437              0                   0
7           37         5                 4              0                   0
8          458         1                36              5                   0
  Pistachios Triticale Carrots Asparagus Garlic Cantaloupes Prunes Olives
1          0         0       0         0      0           0      0      0
2          0         2       0         0      0           0      0      0
3          0         0       0         0      0           0      0      0
4          0         1       0         0      0           0      0      0
5          0         1       0         0      0           0      0      0
6          0         0       0         0      0           0      0      0
7          0         0       0         0      0           0      0      0
8          0         0       0         0      0           0      0      0
  Oranges Honeydew Melons Broccoli Avocados Peppers Pomegranates Nectarines
1       0               0        0        0       0            0          0
2       0               0        0        0       0            0          0
3       0               0        0        0       0            0          0
4       0               0        0        0       0            0          0
5       0               0        0        0       0            0          0
6       0               0        0        0       0            0          0
7       0               0        0        0       0            0          0
8       0               0        0        0       0            0          0
  Greens Plums Strawberries Squash Apricots Vetch Dbl Crop WinWht/Corn
1      0     0            0      0        0     0                    0
2      0     0            0      0        0     0                    2
3      0     0            0      0        0     0                    0
4      0     0            0      0        0     0                    3
5      0     0            0      0        0     0                    0
6      0     0            0      0        0     0                    0
7      0     0            0      0        0     0                    0
8      0     0            0      0        0     0                    0
  Dbl Crop Oats/Corn Lettuce Dbl Crop Triticale/Corn Pumpkins
1                  0       0                       0        0
2                  0       0                       0        0
3                  0       0                       0        0
4                  0       0                       1        1
5                  1       0                       0        0
6                  0       0                       0        0
7                  0       0                       0        0
8                  0       0                       0        0
  Dbl Crop Lettuce/Durum Wht Dbl Crop Lettuce/Cantaloupe
1                          0                           0
2                          0                           0
3                          0                           0
4                          0                           0
5                          0                           0
6                          0                           0
7                          0                           0
8                          0                           0
  Dbl Crop Lettuce/Cotton Dbl Crop Lettuce/Barley Dbl Crop Durum Wht/Sorghum
1                       0                       0                          0
2                       0                       0                          0
3                       0                       0                          0
4                       0                       0                          0
5                       0                       0                          0
6                       0                       0                          0
7                       0                       0                          0
8                       0                       0                          0
  Dbl Crop Barley/Sorghum Dbl Crop WinWht/Sorghum Dbl Crop Barley/Corn
1                       0                       0                    0
2                       0                       0                    0
3                       0                       0                    0
4                       0                       1                    0
5                       0                       0                    0
6                       0                       0                    0
7                       0                       0                    0
8                       0                       0                    0
  Dbl Crop WinWht/Cotton Dbl Crop Soybeans/Cotton Dbl Crop Soybeans/Oats
1                      0                        0                      0
2                      0                        0                      0
3                      0                        0                      0
4                      0                        0                      0
5                      0                        0                      0
6                      0                        0                      0
7                      0                        0                      0
8                      0                        0                      0
  Dbl Crop Corn/Soybeans Blueberries Cabbage Cauliflower Celery Radishes
1                      0           0       0           0      0        0
2                      0           0       0           0      0        0
3                      0           0       0           0      0        0
4                      0           0       0           0      0        0
5                      0           0       0           0      0        0
6                      0           0       0           0      0        0
7                      0           0       0           0      0        0
8                      0           0       0           0      0        0
  Turnips Eggplants Gourds Cranberries Dbl Crop Barley/Soybeans
1       0         0      0           0                        0
2       0         0      0           0                        0
3       0         0      0           0                        0
4       0         0      0           0                        0
5       0         0      0           0                        0
6       0         0      0           0                        0
7       0         0      0           0                        0
8       0         0      0           0                        0</code></pre>
</div>
</div>
<p>We can calculate additional statistics such as the area within the buffer for each site.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Area_m2 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(centre_table_1000m)<span class="sc">*</span><span class="dv">900</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and turn our table into proportional cover of different land classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>centre_table_1000m_prop <span class="ot">&lt;-</span> centre_table_1000m<span class="sc">/</span><span class="fu">rowSums</span>(centre_table_1000m)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>centre_table_1000m_prop <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Area_m2,centre_table_1000m_prop)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>centre_table_1000m_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Area_m2 Background        Corn Cotton Rice      Sorghum    Soybeans Sunflower
1 3196800          0 0.349380631      0    0 0.0033783784 0.287443694         0
2 3195900          0 0.328639820      0    0 0.0000000000 0.272599268         0
3 3193200          0 0.000000000      0    0 0.0000000000 0.000000000         0
4 3192300          0 0.018043417      0    0 0.0000000000 0.022554271         0
5 3194100          0 0.005071851      0    0 0.0002817695 0.001408848         0
6 3196800          0 0.248310811      0    0 0.0002815315 0.235360360         0
7 3194100          0 0.000000000      0    0 0.0000000000 0.000000000         0
8 3193200          0 0.025930101      0    0 0.0000000000 0.000000000         0
  Peanuts Tobacco Sweet Corn Pop or Orn Corn Mint       Barley Durum Wheat
1       0       0          0               0    0 0.0000000000           0
2       0       0          0               0    0 0.0019712757           0
3       0       0          0               0    0 0.0000000000           0
4       0       0          0               0    0 0.0002819284           0
5       0       0          0               0    0 0.0000000000           0
6       0       0          0               0    0 0.0002815315           0
7       0       0          0               0    0 0.0000000000           0
8       0       0          0               0    0 0.0000000000           0
  Spring Wheat Winter Wheat Other Small Grains Dbl Crop WinWht/Soybeans
1            0 0.0633445946                  0                        0
2            0 0.1253168122                  0                        0
3            0 0.0000000000                  0                        0
4            0 0.0019734987                  0                        0
5            0 0.0002817695                  0                        0
6            0 0.0067567568                  0                        0
7            0 0.0000000000                  0                        0
8            0 0.0000000000                  0                        0
           Rye        Oats Millet Speltz Canola Flaxseed Safflower Rape Seed
1 0.0005630631 0.005630631      0      0      0        0         0         0
2 0.0019712757 0.038299071      0      0      0        0         0         0
3 0.0000000000 0.000000000      0      0      0        0         0         0
4 0.0000000000 0.000000000      0      0      0        0         0         0
5 0.0000000000 0.000000000      0      0      0        0         0         0
6 0.0000000000 0.000000000      0      0      0        0         0         0
7 0.0000000000 0.000000000      0      0      0        0         0         0
8 0.0000000000 0.000000000      0      0      0        0         0         0
  Mustard     Alfalfa Other Hay/Non Alfalfa Camelina Buckwheat Sugarbeets
1       0 0.043918919           0.024774775        0         0          0
2       0 0.028161081           0.008166714        0         0          0
3       0 0.000000000           0.000000000        0         0          0
4       0 0.023118128           0.115590640        0         0          0
5       0 0.000563539           0.014088476        0         0          0
6       0 0.034909910           0.114583333        0         0          0
7       0 0.000000000           0.000000000        0         0          0
8       0 0.001127396           0.007046223        0         0          0
     Dry Beans Potatoes Other Crops Sugarcane Sweet Potatoes Misc Vegs &amp; Fruits
1 0.0121058559        0           0         0              0                  0
2 0.0332300760        0           0         0              0                  0
3 0.0000000000        0           0         0              0                  0
4 0.0000000000        0           0         0              0                  0
5 0.0002817695        0           0         0              0                  0
6 0.0000000000        0           0         0              0                  0
7 0.0000000000        0           0         0              0                  0
8 0.0000000000        0           0         0              0                  0
  Watermelons Onions Cucumbers Chick Peas Lentils Peas     Tomatoes Caneberries
1           0      0         0          0       0    0 0.0000000000           0
2           0      0         0          0       0    0 0.0000000000           0
3           0      0         0          0       0    0 0.0000000000           0
4           0      0         0          0       0    0 0.0002819284           0
5           0      0         0          0       0    0 0.0002817695           0
6           0      0         0          0       0    0 0.0000000000           0
7           0      0         0          0       0    0 0.0000000000           0
8           0      0         0          0       0    0 0.0000000000           0
  Hops Herbs Clover/Wildflowers Sod/Grass Seed Switchgrass Fallow/Idle Cropland
1    0     0                  0              0           0                    0
2    0     0                  0              0           0                    0
3    0     0                  0              0           0                    0
4    0     0                  0              0           0                    0
5    0     0                  0              0           0                    0
6    0     0                  0              0           0                    0
7    0     0                  0              0           0                    0
8    0     0                  0              0           0                    0
  Forest Cherries Peaches       Apples Grapes Christmas Trees Other Tree Crops
1      0        0       0 0.0000000000      0               0                0
2      0        0       0 0.0000000000      0               0                0
3      0        0       0 0.0000000000      0               0                0
4      0        0       0 0.0002819284      0               0                0
5      0        0       0 0.0000000000      0               0                0
6      0        0       0 0.0002815315      0               0                0
7      0        0       0 0.0000000000      0               0                0
8      0        0       0 0.0000000000      0               0                0
  Citrus Pecans Almonds Walnuts Pears Clouds/No Data Developed Water Wetlands
1      0      0       0       0     0              0         0     0        0
2      0      0       0       0     0              0         0     0        0
3      0      0       0       0     0              0         0     0        0
4      0      0       0       0     0              0         0     0        0
5      0      0       0       0     0              0         0     0        0
6      0      0       0       0     0              0         0     0        0
7      0      0       0       0     0              0         0     0        0
8      0      0       0       0     0              0         0     0        0
  Nonag/Undefined Aquaculture Open Water Perennial Ice/Snow
1               0           0  0.0000000                  0
2               0           0  0.0000000                  0
3               0           0  0.0000000                  0
4               0           0  0.0000000                  0
5               0           0  0.4567484                  0
6               0           0  0.0000000                  0
7               0           0  0.0000000                  0
8               0           0  0.0000000                  0
  Developed/Open Space Developed/Low Intensity Developed/Med Intensity
1           0.06306306            0.0194256757            0.0061936937
2           0.01464376            0.0267530273            0.0126724866
3           0.05862458            0.0025366404            0.0005636979
4           0.08401466            0.1034677192            0.1130532845
5           0.04846436            0.0267681037            0.0092983939
6           0.08417793            0.0602477477            0.0061936937
7           0.03803888            0.0002817695            0.0000000000
8           0.04565953            0.0022547914            0.0002818489
  Developed/High Intensity       Barren Deciduous Forest Evergreen Forest
1             0.0005630631 0.0011261261       0.05011261     0.0028153153
2             0.0022528865 0.0000000000       0.03266685     0.0002816108
3             0.0000000000 0.0000000000       0.91967306     0.0002818489
4             0.0386241895 0.0002819284       0.13363406     0.0298844094
5             0.0000000000 0.0019723866       0.11017188     0.0098619329
6             0.0011261261 0.0002815315       0.06644144     0.0016891892
7             0.0000000000 0.0000000000       0.94618202     0.0025359256
8             0.0000000000 0.0019729425       0.62457723     0.1502254791
  Mixed Forest    Shrubland Grassland/Pasture Woody Wetlands
1  0.006193694 0.0000000000       0.059966216    0.000000000
2  0.003379330 0.0000000000       0.067868206    0.000000000
3  0.015783540 0.0000000000       0.002536640    0.000000000
4  0.085424302 0.0002819284       0.227234282    0.000000000
5  0.194984503 0.0002817695       0.116934348    0.001408848
6  0.015765766 0.0002815315       0.123029279    0.000000000
7  0.010425472 0.0014088476       0.001127078    0.000000000
8  0.129086809 0.0002818489       0.010146561    0.001409245
  Herbaceous Wetlands Pistachios    Triticale Carrots Asparagus Garlic
1        0.0000000000          0 0.0000000000       0         0      0
2        0.0000000000          0 0.0005632216       0         0      0
3        0.0000000000          0 0.0000000000       0         0      0
4        0.0000000000          0 0.0002819284       0         0      0
5        0.0002817695          0 0.0002817695       0         0      0
6        0.0000000000          0 0.0000000000       0         0      0
7        0.0000000000          0 0.0000000000       0         0      0
8        0.0000000000          0 0.0000000000       0         0      0
  Cantaloupes Prunes Olives Oranges Honeydew Melons Broccoli Avocados Peppers
1           0      0      0       0               0        0        0       0
2           0      0      0       0               0        0        0       0
3           0      0      0       0               0        0        0       0
4           0      0      0       0               0        0        0       0
5           0      0      0       0               0        0        0       0
6           0      0      0       0               0        0        0       0
7           0      0      0       0               0        0        0       0
8           0      0      0       0               0        0        0       0
  Pomegranates Nectarines Greens Plums Strawberries Squash Apricots Vetch
1            0          0      0     0            0      0        0     0
2            0          0      0     0            0      0        0     0
3            0          0      0     0            0      0        0     0
4            0          0      0     0            0      0        0     0
5            0          0      0     0            0      0        0     0
6            0          0      0     0            0      0        0     0
7            0          0      0     0            0      0        0     0
8            0          0      0     0            0      0        0     0
  Dbl Crop WinWht/Corn Dbl Crop Oats/Corn Lettuce Dbl Crop Triticale/Corn
1         0.0000000000       0.0000000000       0            0.0000000000
2         0.0005632216       0.0000000000       0            0.0000000000
3         0.0000000000       0.0000000000       0            0.0000000000
4         0.0008457852       0.0000000000       0            0.0002819284
5         0.0000000000       0.0002817695       0            0.0000000000
6         0.0000000000       0.0000000000       0            0.0000000000
7         0.0000000000       0.0000000000       0            0.0000000000
8         0.0000000000       0.0000000000       0            0.0000000000
      Pumpkins Dbl Crop Lettuce/Durum Wht Dbl Crop Lettuce/Cantaloupe
1 0.0000000000                          0                           0
2 0.0000000000                          0                           0
3 0.0000000000                          0                           0
4 0.0002819284                          0                           0
5 0.0000000000                          0                           0
6 0.0000000000                          0                           0
7 0.0000000000                          0                           0
8 0.0000000000                          0                           0
  Dbl Crop Lettuce/Cotton Dbl Crop Lettuce/Barley Dbl Crop Durum Wht/Sorghum
1                       0                       0                          0
2                       0                       0                          0
3                       0                       0                          0
4                       0                       0                          0
5                       0                       0                          0
6                       0                       0                          0
7                       0                       0                          0
8                       0                       0                          0
  Dbl Crop Barley/Sorghum Dbl Crop WinWht/Sorghum Dbl Crop Barley/Corn
1                       0            0.0000000000                    0
2                       0            0.0000000000                    0
3                       0            0.0000000000                    0
4                       0            0.0002819284                    0
5                       0            0.0000000000                    0
6                       0            0.0000000000                    0
7                       0            0.0000000000                    0
8                       0            0.0000000000                    0
  Dbl Crop WinWht/Cotton Dbl Crop Soybeans/Cotton Dbl Crop Soybeans/Oats
1                      0                        0                      0
2                      0                        0                      0
3                      0                        0                      0
4                      0                        0                      0
5                      0                        0                      0
6                      0                        0                      0
7                      0                        0                      0
8                      0                        0                      0
  Dbl Crop Corn/Soybeans Blueberries Cabbage Cauliflower Celery Radishes
1                      0           0       0           0      0        0
2                      0           0       0           0      0        0
3                      0           0       0           0      0        0
4                      0           0       0           0      0        0
5                      0           0       0           0      0        0
6                      0           0       0           0      0        0
7                      0           0       0           0      0        0
8                      0           0       0           0      0        0
  Turnips Eggplants Gourds Cranberries Dbl Crop Barley/Soybeans
1       0         0      0           0                        0
2       0         0      0           0                        0
3       0         0      0           0                        0
4       0         0      0           0                        0
5       0         0      0           0                        0
6       0         0      0           0                        0
7       0         0      0           0                        0
8       0         0      0           0                        0</code></pre>
</div>
</div>
</section>
<section id="write-out-shapefiles" class="level2">
<h2 class="anchored" data-anchor-id="write-out-shapefiles">Write out shapefiles</h2>
<p>we can write out vector data to shapefiles using <code>st_write()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(centre_sites, <span class="st">"data/centre_sites.shp"</span>, <span class="at">delete_layer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deleting layer `centre_sites' using driver `ESRI Shapefile'
Writing layer `centre_sites' to data source 
  `data/centre_sites.shp' using driver `ESRI Shapefile'
Writing 8 features with 1 fields and geometry type Point.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(centre_sites_1000m, <span class="st">"data/centre_sites_buffer_1000m.shp"</span>, <span class="at">delete_layer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deleting layer `centre_sites_buffer_1000m' using driver `ESRI Shapefile'
Writing layer `centre_sites_buffer_1000m' to data source 
  `data/centre_sites_buffer_1000m.shp' using driver `ESRI Shapefile'
Writing 8 features with 1 fields and geometry type Polygon.</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>